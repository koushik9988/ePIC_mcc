import numpy as np
import matplotlib.pyplot as plt

#------------------------- Cross Sections ----------------
def cs_pion(energy):
    return (1e-20 * 5.74 * (energy / 13.61) ** -0.5765) / (1 + (energy / 27.9) ** 1.1605)

def cs_nion(energy):
    return (1e-20 * 6.36 * (energy / 13.61) ** -0.337) / (1.0 + (energy / 5.5) ** 0.493 + (energy / 26.0) ** 1.429)

def cs_e_detach(energy):
    if energy <= 2.25:
        return 0.0
    return ((1e-20 * 4.19e-2 * ((energy - 2.25) / 13.61) ** 1.89) /
           (1.0 + ((energy - 2.25) / 178.0) ** 1.66 + ((energy - 2.25) / 1040.0) ** 2.76) +
           (1e-20 * 16.5 * ((energy - 2.25) / 13.61) ** 1.088) /
           (1.0 + ((energy - 2.25) / 5.33) ** 1.254))

# ---------------- Tabulated H2 Elastic Data ----------------
h2_data = np.array([
[1.000000e-4,7.241000e-20],[3.514217e-2,8.750300e-20],[7.151931e-2,9.828000e-20],
[1.091748e-1,1.064900e-19],[1.481536e-1,1.132000e-19],[1.885022e-1,1.188200e-19],
[2.302688e-1,1.233500e-19],[2.735031e-1,1.275600e-19],[3.182567e-1,1.314800e-19],
[3.645831e-1,1.352300e-19],[4.125375e-1,1.389900e-19],[4.621772e-1,1.425100e-19],
[5.135612e-1,1.460700e-19],[5.667511e-1,1.494700e-19],[6.218101e-1,1.526900e-19],
[7.378008e-1,1.585300e-19],[8.620871e-1,1.642500e-19],[9.952623e-1,1.699000e-19],
[1.137962e+0,1.748600e-19],[1.371374e+0,1.790000e-19],[2.126079e+0,1.742300e-19],
[2.349654e+0,1.693100e-19],[2.589219e+0,1.637700e-19],[2.845918e+0,1.573500e-19],
[2.981072e+0,1.539700e-19],[3.120975e+0,1.504800e-19],[3.265795e+0,1.468600e-19],
[3.415704e+0,1.431100e-19],[3.570882e+0,1.392300e-19],[3.731513e+0,1.352100e-19],
[3.897788e+0,1.310600e-19],[4.069907e+0,1.271400e-19],[4.248075e+0,1.236600e-19],
[4.432503e+0,1.200700e-19],[4.623413e+0,1.163400e-19],[4.821032e+0,1.124900e-19],
[5.025596e+0,1.086300e-19],[5.237348e+0,1.055600e-19],[5.456542e+0,1.023800e-19],
[5.683439e+0,9.909000e-20],[5.918310e+0,9.568500e-20],[6.161434e+0,9.248200e-20],
[6.413102e+0,8.933600e-20],[6.673615e+0,8.608000e-20],[6.943282e+0,8.270900e-20],
[7.222426e+0,7.977600e-20],[7.511380e+0,7.688600e-20],[7.810489e+0,7.389500e-20],
[8.120108e+0,7.091900e-20],[8.440609e+0,6.803500e-20],[8.772372e+0,6.504900e-20],
[9.115795e+0,6.218900e-20],[9.471285e+0,5.970100e-20],[9.839269e+0,5.712500e-20],
[1.022018e+1,5.473400e-20],[1.061449e+1,5.246700e-20],[1.102264e+1,5.012000e-20],
[1.144515e+1,4.769000e-20],[1.188250e+1,4.517600e-20],[1.233521e+1,4.318700e-20],
[1.280384e+1,4.135200e-20],[1.328894e+1,3.945200e-20],[1.379108e+1,3.748500e-20],
[1.431087e+1,3.544900e-20],[1.484893e+1,3.334200e-20],[1.540590e+1,3.174100e-20],
[1.598244e+1,3.030700e-20],[1.657924e+1,2.882300e-20],[1.719701e+1,2.728700e-20],
[1.783649e+1,2.569700e-20],[1.849845e+1,2.435500e-20],[1.918366e+1,2.307100e-20],
[1.989296e+1,2.174100e-20],[2.062719e+1,2.069000e-20],[2.138721e+1,1.965900e-20],
[2.217395e+1,1.859200e-20],[2.298833e+1,1.748800e-20],[2.383133e+1,1.634500e-20],
[2.470396e+1,1.516100e-20],[2.560725e+1,1.430300e-20],[2.654229e+1,1.360000e-20],
[2.751018e+1,1.287200e-20],[2.851209e+1,1.211900e-20],[2.954921e+1,1.133900e-20],
[3.062278e+1,1.075200e-20],[3.173407e+1,1.031000e-20],[3.288442e+1,9.852000e-21],
[3.407519e+1,9.378100e-21],[3.530781e+1,8.887500e-21],[3.658374e+1,8.379700e-21],
[3.790451e+1,7.854000e-21],[3.927170e+1,7.309900e-21],[4.068694e+1,6.884700e-21],
[4.215191e+1,6.596100e-21],[4.366836e+1,6.297300e-21],[4.523810e+1,5.988100e-21],
[4.686301e+1,5.668000e-21],[4.854502e+1,5.336600e-21],[5.028614e+1,5.012800e-21],
[5.208844e+1,4.778500e-21],[5.395409e+1,4.536000e-21],[5.588529e+1,4.284900e-21],
[5.788437e+1,4.025000e-21],[5.995369e+1,3.756000e-21],[6.209573e+1,3.582300e-21],
[6.431306e+1,3.405000e-21],[6.660830e+1,3.221300e-21],[6.898420e+1,3.031300e-21],
[7.144360e+1,2.867700e-21],[7.398942e+1,2.722600e-21],[7.662471e+1,2.572400e-21],
[7.935261e+1,2.416900e-21],[8.217638e+1,2.286400e-21],[8.509938e+1,2.160700e-21],
[8.812509e+1,2.030600e-21],[9.125714e+1,1.918600e-21],[9.449926e+1,1.837500e-21],
[9.785531e+1,1.753600e-21],[1.013293e+2,1.671300e-21],[1.049254e+2,1.593600e-21],
[1.086478e+2,1.513200e-21],[1.125011e+2,1.430000e-21],[1.164898e+2,1.343800e-21],
[1.206186e+2,1.254600e-21],[1.248925e+2,1.162300e-21],[1.293167e+2,1.109600e-21],
[1.338963e+2,1.056100e-21],[1.386368e+2,1.000700e-21],[1.435440e+2,9.434100e-22],
[1.486236e+2,8.840800e-22],[1.538817e+2,8.360200e-22],[1.593245e+2,7.911700e-22],
[1.649587e+2,7.447400e-22],[1.707908e+2,6.966800e-22],[1.768279e+2,6.519100e-22],
[1.830772e+2,6.174100e-22],[1.895461e+2,5.817100e-22],[1.962423e+2,5.447400e-22],
[2.031738e+2,5.131500e-22],[2.103489e+2,4.886100e-22],[2.177762e+2,4.632100e-22],
[2.254644e+2,4.369100e-22],[2.334229e+2,4.096900e-22],[2.416610e+2,3.815200e-22],
[2.501886e+2,3.526300e-22],[2.590160e+2,3.355100e-22],[2.681535e+2,3.177800e-22],
[2.776121e+2,2.994300e-22],[2.874032e+2,2.804400e-22],[2.975383e+2,2.607800e-22],
[3.080295e+2,2.462000e-22],[3.188895e+2,2.329500e-22],[3.301311e+2,2.192400e-22],
[3.417678e+2,2.050400e-22],[3.538134e+2,1.918700e-22],[3.662823e+2,1.816500e-22],
[3.791894e+2,1.710600e-22],[3.925501e+2,1.601100e-22],[4.063803e+2,1.503000e-22],
[4.206965e+2,1.420000e-22],[4.355158e+2,1.334000e-22],[4.508559e+2,1.246200e-22],
[4.667351e+2,1.176400e-22],[4.831724e+2,1.104000e-22],[5.001872e+2,1.029500e-22],
[5.178000e+2,9.796300e-23],[5.360318e+2,9.280300e-23],[5.549043e+2,8.746200e-23],
[5.744399e+2,8.193300e-23],[5.946621e+2,7.621100e-23],[6.155950e+2,7.189300e-23],
[6.372635e+2,6.799300e-23],[6.596934e+2,6.395500e-23],[6.829116e+2,5.977600e-23],
[7.069458e+2,5.586000e-23],[7.318245e+2,5.284900e-23],[7.575776e+2,4.973300e-23],
[7.842356e+2,4.650700e-23],[8.118305e+2,4.359400e-23],[8.403951e+2,4.116600e-23],
[8.699636e+2,3.865300e-23],[9.005711e+2,3.606500e-23],[9.322543e+2,3.410000e-23],
[9.650509e+2,3.206700e-23]
])

h2_E = h2_data[:,0]
h2_cs = h2_data[:,1]

energies = np.logspace(-4, 2, 400)  # 0.1 eV to 100 eV

cs_pion_vals = [cs_pion(E) for E in energies]
cs_nion_vals = [cs_nion(E) for E in energies]
cs_detach_vals = [cs_e_detach(E) for E in energies]


figsize = np.array([80,80/1.618])
ppi = np.sqrt(1920**2+1200**2)/24


plt.figure(figsize = figsize/10.4, dpi=ppi)
plt.loglog(energies, cs_pion_vals, label=r"$\mathrm{H^+ + H_2 \;\; elastic}$")
plt.loglog(energies, cs_nion_vals, label=r"$\mathrm{H^- + H_2 \;\; elastic}$")
plt.loglog(energies, cs_detach_vals, label=r"$\mathrm{H^- + H_2 \rightarrow e^- + fast\;H \; detachment}$")
plt.loglog(h2_E, h2_cs,label=r"$\mathrm{e + H_2 \;\; elastic}$")

plt.xlabel("Energy (eV)", fontsize=12)
plt.ylabel("Cross Section (mÂ²)", fontsize=12)
plt.title("Cross Sections vs Energy", fontsize=14)
plt.legend()
#plt.grid(True, which="both", ls="--", lw=0.5)
plt.tight_layout()
plt.savefig('cross_sections.pdf', dpi=300)
plt.show()
